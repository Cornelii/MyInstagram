{% extends 'base.html' %}

{% block body %}
  <div class="row justify-content-center">
  
    {% for post in posts %}
          <div class="card" style="width: 15rem;">
              <div class="card-header">
                <span>{{ post.user.username }}</span>
              </div>
              
              {% if post.image %}
                <img src="{{post.image.url}}" class="card-img-top" alt="...">
              {% else %}
                <img src="https://picsum.photos/200/200/?random" class="card-img-top" alt="...">
              {% endif %}

            
            <div class="card-body">
              <p class="card-text">{{post.content}}</p>
              
              <!-- 작성자만 수정/삭제 가능  -->
              {% if post.user == request.user  %}
                <form method="POST" action = "{% url 'posts:delete' post.id %}" class="d-inline-block">
                  {% csrf_token %}
                  <button class="btn btn-danger">삭제</button>
                </form>
                <a href="{% url 'posts:update' post.id %}" class="btn btn-success">수정</a>
              {% endif%}
            </div>
            <!--좋아요 버튼 추가-->
            <div class="card-body">
              <a href="{% url 'posts:like' post.id %}">
                <!-- 해당유저가 like를 했으면   -->
                {% if user in post.like_users.all %}
                  <i class="fas fa-heart"></i>
                {% else %}
                <!-- 아니면  -->
                  <i class="far fa-heart"></i>
                {% endif %}
              </a>
              <p class="card-text">
                {{post.like_users.count}}명이 좋아합니다.
              </p>
            </div>
            
          </div>
    {% endfor %}
  
  </div>  
{% endblock %}

